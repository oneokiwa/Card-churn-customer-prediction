# ===================================================================================
# ğŸ“Œ ë°ì´í„° ì „ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸ ìš”ì•½
# 1ï¸âƒ£ ê²°ì¸¡ì¹˜ ì²˜ë¦¬
# 2ï¸âƒ£ ì¸ì½”ë”© ì‘ì—…
# 3ï¸âƒ£ ì—´ ì •ë¦¬
# 4ï¸âƒ£ ë³€ìˆ˜ëª… ì˜ì–´ë¡œ ë³€í™˜
# ìµœì¢… ê²°ê³¼ íŒŒì¼: "data/ì—´ë¶„ë¦¬_ì˜ì–´ë³€í™˜.csv"
# ===================================================================================

######## 1ï¸âƒ£. ê²°ì¸¡ì¹˜ ëŒ€ì²´ ########
import pandas as pd

# ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
data = pd.read_csv("data/ì¢…í•©ì •ë³´_íšŒì›ë²ˆí˜¸ê¸°ì¤€_10ì›”í¬í•¨_ì´íƒˆê³ ê°_ê· í˜•.csv")

# ê²°ì¸¡ì¹˜ë¥¼ "ì—†ìŒ"ìœ¼ë¡œ ëŒ€ì²´í•  ì—´ ëª©ë¡
columns_to_replace = [
    "201807_ì§ì¥ì‹œë„ëª…",
    "201808_ì§ì¥ì‹œë„ëª…",
    "201809_ì§ì¥ì‹œë„ëª…",
    "201810_ì§ì¥ì‹œë„ëª…"
]

# í•´ë‹¹ ì—´ë“¤ì˜ ê²°ì¸¡ì¹˜ë¥¼ "ì—†ìŒ"ìœ¼ë¡œ ëŒ€ì²´
data[columns_to_replace] = data[columns_to_replace].fillna("ì—†ìŒ")

# ë³€ê²½ëœ ë°ì´í„°ë¥¼ ìƒˆ íŒŒì¼ë¡œ ì €ì¥
data.to_csv("data/ì¢…í•©ì •ë³´_10ì›”í¬í•¨_ê²°ì¸¡ì¹˜ì²˜ë¦¬.csv", index=False)

# í™•ì¸ ë©”ì‹œì§€
print("ê²°ì¸¡ì¹˜ê°€ 'ì—†ìŒ'ìœ¼ë¡œ ëŒ€ì²´ëœ íŒŒì¼ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.")


###### 2ï¸âƒ£. ì›-í•« ì¸ì½”ë”©, ë ˆì´ë¸” ì¸ì½”ë”© ìˆ˜í–‰ #########
# "data/ì¢…í•©ì •ë³´_10ì›”í¬í•¨_ê²°ì¸¡ì¹˜ì²˜ë¦¬.csv"

### 1. ê±°ì£¼ì‹œë„, ì§ì¥ì‹œë„ 18ê°œë¡œ ì¸ì½”ë”© ###

# íŒŒì¼ ê²½ë¡œ
input_file = "data/ì¢…í•©ì •ë³´_10ì›”í¬í•¨_ê²°ì¸¡ì¹˜ì²˜ë¦¬.csv"
output_file = "data/ê±°ì£¼ì‹œë„_ì§ì¥ì‹œë„_ì¸ì½”ë”©.csv"

# ë°ì´í„° ì½ê¸°
df = pd.read_csv(input_file)

# ì›-í•« ì¸ì½”ë”©ì„ ìˆ˜í–‰í•  ì—´ ì´ë¦„ë“¤
columns_to_encode = [
    '201807_ê±°ì£¼ì‹œë„ëª…', '201808_ê±°ì£¼ì‹œë„ëª…', '201809_ê±°ì£¼ì‹œë„ëª…', '201810_ê±°ì£¼ì‹œë„ëª…',
    '201807_ì§ì¥ì‹œë„ëª…', '201808_ì§ì¥ì‹œë„ëª…', '201809_ì§ì¥ì‹œë„ëª…', '201810_ì§ì¥ì‹œë„ëª…'
]

# ê±°ì£¼ì‹œë„ëª…/ì§ì¥ì‹œë„ëª… ê°’ ë¦¬ìŠ¤íŠ¸ (ì—†ìŒ í¬í•¨)
city_names = ['ì„œìš¸', 'ë¶€ì‚°', 'ëŒ€êµ¬', 'ì¸ì²œ', 'ê´‘ì£¼', 'ëŒ€ì „', 'ìš¸ì‚°', 'ì„¸ì¢…',
              'ê²½ê¸°', 'ê°•ì›', 'ì¶©ë¶', 'ì¶©ë‚¨', 'ì „ë¶', 'ì „ë‚¨', 'ê²½ë¶', 'ê²½ë‚¨', 'ì œì£¼', 'ì—†ìŒ']

# ê¸°ì¡´ ì—´ì„ ì›-í•« ì¸ì½”ë”©í•˜ì—¬ ë®ì–´ì“°ê¸°
for col in columns_to_encode:
    # í•´ë‹¹ ì—´ì„ ì›-í•« ì¸ì½”ë”©
    df[col] = df[col].apply(lambda x: [1 if city == x else 0 for city in city_names])

# ê²°ê³¼ë¥¼ ìƒˆë¡œìš´ CSV íŒŒì¼ë¡œ ì €ì¥
df.to_csv(output_file, index=False)

print(f"ì›-í•« ì¸ì½”ë”© ê²°ê³¼ê°€ '{output_file}'ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.")

### 2. Life Stage ë ˆì´ë¸” ì¸ì½”ë”© ###

# íŒŒì¼ ê²½ë¡œ
input_file = "data/ê±°ì£¼ì‹œë„_ì§ì¥ì‹œë„_ì¸ì½”ë”©.csv"
output_file = "data/Life_Stage_ì¸ì½”ë”©.csv"

# ë°ì´í„° ì½ê¸°
df = pd.read_csv(input_file)

# ë ˆì´ë¸” ì¸ì½”ë”©ì„ ìˆ˜í–‰í•  ì—´ ì´ë¦„ë“¤
columns_to_encode = ['201807_Life_Stage', '201808_Life_Stage', '201809_Life_Stage', '201810_Life_Stage']

# Life Stage ë³€ìˆ˜ ìˆœì„œ ì •ì˜
life_stage_order = {
    "1.Single": 1,
    "2.ê°€ì¡±í˜•ì„±ê¸°": 2,
    "3.ìë…€ì¶œì‚°ê¸°": 3,
    "4.ìë…€ì„±ì¥ê¸°(1)": 4,
    "5.ìë…€ì„±ì¥ê¸°(2)": 5,
    "6.ìë…€ì¶œê°€ê¸°": 6,
    "7.ë…¸ë ¹": 7
}

# ë ˆì´ë¸” ì¸ì½”ë”© ìˆ˜í–‰
for col in columns_to_encode:
    df[col] = df[col].map(life_stage_order)

# ê²°ê³¼ë¥¼ ìƒˆë¡œìš´ CSV íŒŒì¼ë¡œ ì €ì¥
df.to_csv(output_file, index=False)

print(f"ë ˆì´ë¸” ì¸ì½”ë”© ê²°ê³¼ê°€ '{output_file}'ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.")

### 3. ì—°ë ¹ ë ˆì´ë¸” ì¸ì½”ë”© ###

# íŒŒì¼ ê²½ë¡œ
input_file = "data/Life_Stage_ì¸ì½”ë”©.csv"
output_file = "data/ì—°ë ¹_ì¸ì½”ë”©.csv"

# ë°ì´í„° ì½ê¸°
df = pd.read_csv(input_file)

# ë ˆì´ë¸” ì¸ì½”ë”©ì„ ìˆ˜í–‰í•  ì—´ ì´ë¦„ë“¤
columns_to_encode = ['201807_ì—°ë ¹', '201808_ì—°ë ¹', '201809_ì—°ë ¹', '201810_ì—°ë ¹']

# ì—°ë ¹ ë³€ìˆ˜ ìˆœì„œ ì •ì˜
age_order = {
    "20ëŒ€": 1,
    "30ëŒ€": 2,
    "40ëŒ€": 3,
    "50ëŒ€": 4,
    "60ëŒ€": 5,
    "70ëŒ€ì´ìƒ": 6
}

# ë ˆì´ë¸” ì¸ì½”ë”© ìˆ˜í–‰
for col in columns_to_encode:
    df[col] = df[col].map(age_order).astype(int)  # ì •ìˆ˜í˜•ìœ¼ë¡œ ë³€í™˜

# ê²°ê³¼ë¥¼ ìƒˆë¡œìš´ CSV íŒŒì¼ë¡œ ì €ì¥
df.to_csv(output_file, index=False)

print(f"ë ˆì´ë¸” ì¸ì½”ë”© ê²°ê³¼ê°€ '{output_file}'ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.")

### 4. ì´ìš©ê¸ˆì•¡ëŒ€ ë ˆì´ë¸” ì¸ì½”ë”© ###

# íŒŒì¼ ê²½ë¡œ
input_file = "data/ì—°ë ¹_ì¸ì½”ë”©.csv"
output_file = "data/ìµœì¢…_ì¸ì½”ë”©.csv"

# ë°ì´í„° ì½ê¸°
df = pd.read_csv(input_file)

# ë ˆì´ë¸” ì¸ì½”ë”©ì„ ìˆ˜í–‰í•  ì—´ ì´ë¦„ë“¤
columns_to_encode = ['201807_ì´ìš©ê¸ˆì•¡ëŒ€', '201808_ì´ìš©ê¸ˆì•¡ëŒ€', '201809_ì´ìš©ê¸ˆì•¡ëŒ€', '201810_ì´ìš©ê¸ˆì•¡ëŒ€']

# ì—°ë ¹ ë³€ìˆ˜ ìˆœì„œ ì •ì˜
amt_use_order = {
    "01.100ë§Œì›+": 1,
    "02.50ë§Œì›+": 2,
    "03.30ë§Œì›+": 3,
    "04.10ë§Œì›+": 4,
    "05.10ë§Œì›-": 5,
    "09.ë¯¸ì‚¬ìš©": 6
}

# ë ˆì´ë¸” ì¸ì½”ë”© ìˆ˜í–‰
for col in columns_to_encode:
    df[col] = df[col].map(amt_use_order)

# ê²°ê³¼ë¥¼ ìƒˆë¡œìš´ CSV íŒŒì¼ë¡œ ì €ì¥
df.to_csv(output_file, index=False)

print(f"ë ˆì´ë¸” ì¸ì½”ë”© ê²°ê³¼ê°€ '{output_file}'ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.")

### 5. ë‚¨ë…€êµ¬ë¶„ì½”ë“œ í•˜ë‚˜ë§Œ ë‚¨ê¸°ê¸° (ë¶ˆí•„ìš”í•œ ì¤‘ë³µ ì—´ ì œì™¸) ###

# íŒŒì¼ ê²½ë¡œ ì„¤ì •
input_file = "data/ìµœì¢…_ì¸ì½”ë”©.csv"

# ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
df = pd.read_csv(input_file)

# '201807_ë‚¨ë…€êµ¬ë¶„ì½”ë“œ' ì—´ë§Œ ë‚¨ê¸°ê³  ë‚˜ë¨¸ì§€ ì—´ ì‚­ì œ
df = df.drop(columns=["201808_ë‚¨ë…€êµ¬ë¶„ì½”ë“œ", "201809_ë‚¨ë…€êµ¬ë¶„ì½”ë“œ", "201810_ë‚¨ë…€êµ¬ë¶„ì½”ë“œ"])

# '201807_ë‚¨ë…€êµ¬ë¶„ì½”ë“œ' ì—´ ì´ë¦„ì„ 'ë‚¨ë…€êµ¬ë¶„ì½”ë“œ'ë¡œ ìˆ˜ì •
df = df.rename(columns={"201807_ë‚¨ë…€êµ¬ë¶„ì½”ë“œ": "ë‚¨ë…€êµ¬ë¶„ì½”ë“œ"})

# ê²°ê³¼ë¥¼ ê¸°ì¡´ íŒŒì¼ì— ë®ì–´ì“°ê¸°
df.to_csv(input_file, index=False, encoding="utf-8-sig")
print(f"ë‚¨ë…€êµ¬ë¶„ì½”ë“œ ìˆ˜ì •ëœ ë°ì´í„°ë¥¼ '{input_file}'ì— ë®ì–´ì¼ìŠµë‹ˆë‹¤.")


### 6. ê±°ì£¼ì‹œë„ëª…, ì§ì¥ì‹œë„ëª… í•˜ë‚˜ë§Œ ë‚¨ê¸°ê¸° ###

# íŒŒì¼ ê²½ë¡œ ì„¤ì •
input_file = "data/ìµœì¢…_ì¸ì½”ë”©.csv"

# ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
df = pd.read_csv(input_file)

# '201807_ì§ì¥ì‹œë„ëª…, ê±°ì£¼ì‹œë„ëª…' ì—´ë§Œ ë‚¨ê¸°ê³  ë‚˜ë¨¸ì§€ ì—´ ì‚­ì œ
df = df.drop(columns=["201808_ê±°ì£¼ì‹œë„ëª…", "201809_ê±°ì£¼ì‹œë„ëª…", "201810_ê±°ì£¼ì‹œë„ëª…", "201808_ì§ì¥ì‹œë„ëª…", "201809_ì§ì¥ì‹œë„ëª…", "201810_ì§ì¥ì‹œë„ëª…"])

# '201807_ì§ì¥, ê±°ì£¼' ì—´ ì´ë¦„ì„ 'ì§ì¥, ê±°ì£¼'ë¡œ ìˆ˜ì •
df = df.rename(columns={"201807_ê±°ì£¼ì‹œë„ëª…": "ê±°ì£¼ì‹œë„ëª…"})
df = df.rename(columns={"201807_ì§ì¥ì‹œë„ëª…": "ì§ì¥ì‹œë„ëª…"})

# ê²°ê³¼ë¥¼ ê¸°ì¡´ íŒŒì¼ì— ë®ì–´ì“°ê¸°
df.to_csv(input_file, index=False, encoding="utf-8-sig")
print(f"ê±°ì£¼, ì§ì¥ì‹œë„ëª… ìˆ˜ì •ëœ ë°ì´í„°ë¥¼ '{input_file}'ì— ë®ì–´ì¼ìŠµë‹ˆë‹¤.")

### 7. ê±°ì£¼ì‹œë„ëª…, ì§ì¥ì‹œë„ëª… ì—´ ë¶„ë¦¬ ###
import ast  # ì•ˆì „í•˜ê²Œ ë¬¸ìì—´ì„ íŒŒì‹±í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬

# "data/ìµœì¢…_ì¸ì½”ë”©.csv" íŒŒì¼ ë¡œë“œ
data = pd.read_csv("data/ìµœì¢…_ì¸ì½”ë”©.csv")

# ë¬¸ìì—´ í˜•íƒœì˜ ë¦¬ìŠ¤íŠ¸ë¥¼ ì‹¤ì œ ë¦¬ìŠ¤íŠ¸ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜ ì •ì˜
def parse_list(column):
    return column.apply(lambda x: ast.literal_eval(x) if isinstance(x, str) else x)

# ê±°ì£¼ì‹œë„ëª…ê³¼ ì§ì¥ì‹œë„ëª… ì—´ì˜ ë¬¸ìì—´ ë¦¬ìŠ¤íŠ¸ë¥¼ ì‹¤ì œ ë¦¬ìŠ¤íŠ¸ë¡œ ë³€í™˜
data["ê±°ì£¼ì‹œë„ëª…"] = parse_list(data["ê±°ì£¼ì‹œë„ëª…"])
data["ì§ì¥ì‹œë„ëª…"] = parse_list(data["ì§ì¥ì‹œë„ëª…"])

# ê±°ì£¼ì‹œë„ëª… ë¦¬ìŠ¤íŠ¸ì—ì„œ ê° ë²”ì£¼ë¥¼ ê°œë³„ ì—´ë¡œ ë¶„ë¦¬
residence_categories = [
    "ì„œìš¸", "ë¶€ì‚°", "ëŒ€êµ¬", "ì¸ì²œ", "ê´‘ì£¼", "ëŒ€ì „", "ìš¸ì‚°", "ì„¸ì¢…",
    "ê²½ê¸°", "ê°•ì›", "ì¶©ë¶", "ì¶©ë‚¨", "ì „ë¶", "ì „ë‚¨", "ê²½ë¶", "ê²½ë‚¨", "ì œì£¼"
]
for idx, category in enumerate(residence_categories):
    column_name = f"ê±°ì£¼ì‹œë„ëª…_{category}"
    data[column_name] = data["ê±°ì£¼ì‹œë„ëª…"].apply(lambda x: x[idx] if isinstance(x, list) else 0)

# ì§ì¥ì‹œë„ëª… ë¦¬ìŠ¤íŠ¸ì—ì„œ ê° ë²”ì£¼ë¥¼ ê°œë³„ ì—´ë¡œ ë¶„ë¦¬
work_categories = residence_categories + ["ì—†ìŒ"]
for idx, category in enumerate(work_categories):
    column_name = f"ì§ì¥ì‹œë„ëª…_{category}"
    data[column_name] = data["ì§ì¥ì‹œë„ëª…"].apply(lambda x: x[idx] if isinstance(x, list) else 0)

# ê¸°ì¡´ì˜ ë¦¬ìŠ¤íŠ¸ í˜•íƒœ ì—´ ì œê±°
data = data.drop(columns=["ê±°ì£¼ì‹œë„ëª…", "ì§ì¥ì‹œë„ëª…"])

# ê²°ê³¼ë¥¼ "data/ì—´ë¶„ë¦¬.csv"ë¡œ ì €ì¥
data.to_csv("data/ì—´ë¶„ë¦¬.csv", index=False)

print("ì—´ ë¶„ë¦¬ í›„ ì €ì¥ ì™„ë£Œ: data/ì—´ë¶„ë¦¬.csv")

########## ì—°ë ¹, VIPë“±ê¸‰ì½”ë“œ í•˜ë‚˜ë§Œ ë‚¨ê¸°ê¸° (ë¶ˆí•„ìš”í•œ ì¤‘ë³µ ì—´ ì œì™¸) ##########

### 8. ì—°ë ¹ ì¤‘ë³µ ì œê±° ###
# íŒŒì¼ ê²½ë¡œ ì„¤ì •
input_file = "data/ì—´ë¶„ë¦¬.csv"

# ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
df = pd.read_csv(input_file)

# '201807_ë‚¨ë…€êµ¬ë¶„ì½”ë“œ' ì—´ë§Œ ë‚¨ê¸°ê³  ë‚˜ë¨¸ì§€ ì—´ ì‚­ì œ
df = df.drop(columns=["201808_ì—°ë ¹", "201809_ì—°ë ¹", "201810_ì—°ë ¹"])

# '201807_ë‚¨ë…€êµ¬ë¶„ì½”ë“œ' ì—´ ì´ë¦„ì„ 'ë‚¨ë…€êµ¬ë¶„ì½”ë“œ'ë¡œ ìˆ˜ì •
df = df.rename(columns={"201807_ì—°ë ¹": "ì—°ë ¹"})

# ê²°ê³¼ë¥¼ ê¸°ì¡´ íŒŒì¼ì— ë®ì–´ì“°ê¸°
df.to_csv(input_file, index=False, encoding="utf-8-sig")
print(f"ì—°ë ¹ ìˆ˜ì •ëœ ë°ì´í„°ë¥¼ '{input_file}'ì— ë®ì–´ì¼ìŠµë‹ˆë‹¤.")

### 9. VIP ë“±ê¸‰ ì½”ë“œ ì¤‘ë³µ ì œê±° ###
# íŒŒì¼ ê²½ë¡œ ì„¤ì •
input_file = "data/ì—´ë¶„ë¦¬.csv"

# ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
df = pd.read_csv(input_file)

# '201807_ë‚¨ë…€êµ¬ë¶„ì½”ë“œ' ì—´ë§Œ ë‚¨ê¸°ê³  ë‚˜ë¨¸ì§€ ì—´ ì‚­ì œ
df = df.drop(columns=["201808_VIPë“±ê¸‰ì½”ë“œ", "201809_VIPë“±ê¸‰ì½”ë“œ", "201810_VIPë“±ê¸‰ì½”ë“œ"])

# '201807_ë‚¨ë…€êµ¬ë¶„ì½”ë“œ' ì—´ ì´ë¦„ì„ 'ë‚¨ë…€êµ¬ë¶„ì½”ë“œ'ë¡œ ìˆ˜ì •
df = df.rename(columns={"201807_VIPë“±ê¸‰ì½”ë“œ": "VIPë“±ê¸‰ì½”ë“œ"})

# ê²°ê³¼ë¥¼ ê¸°ì¡´ íŒŒì¼ì— ë®ì–´ì“°ê¸°
df.to_csv(input_file, index=False, encoding="utf-8-sig")
print(f"VIPë“±ê¸‰ì½”ë“œ ìˆ˜ì •ëœ ë°ì´í„°ë¥¼ '{input_file}'ì— ë®ì–´ì¼ìŠµë‹ˆë‹¤.")


# ----------------------------------------------------------------------------------

######### ì˜ë¬¸ ë³€ê²½ ############

# íŒŒì¼ ê²½ë¡œ ì„¤ì •
input_file = "data/ì—´ë¶„ë¦¬.csv"
output_file = "data/ì—´ë¶„ë¦¬_ì˜ì–´ë³€í™˜.csv"

# CSV íŒŒì¼ ë¡œë“œ
data = pd.read_csv(input_file)

# ë³€ìˆ˜ëª… ë³€ê²½ ë§µí•‘ (ì ‘ë‘ì–´ëŠ” ìœ ì§€)
column_mapping = {
    "ê¸°ì¤€ë…„ì›”": "YearMonth",
    "ë°œê¸‰íšŒì›ë²ˆí˜¸": "MemberID",
    "VIPë“±ê¸‰ì½”ë“œ": "VIPGradeCode",
    "ë‚¨ë…€êµ¬ë¶„ì½”ë“œ": "GenderCode",
    "íšŒì›ì—¬ë¶€_ì´ìš©ê°€ëŠ¥": "MembershipAvailable",
    "ê±°ì£¼ì‹œë„ëª…": "ResidenceCity",
    "ì§ì¥ì‹œë„ëª…": "WorkCity",
    "ìœ íš¨ì¹´ë“œìˆ˜_ì‹ ìš©": "ValidCardCount",
    "ì´ìš©ì¹´ë“œìˆ˜_ì‹ ìš©": "UsedCardCount",
    "ì—°ë ¹": "Age",
    "Life_Stage": "LifeStage",
    "ì”ì•¡_B0M": "Balance_B0M",
    "ì—°ì²´ì”ì•¡_B0M": "OverdueBalance_B0M",
    "ì¹´ë“œì´ìš©í•œë„ê¸ˆì•¡": "CardLimit",
    "ì²­êµ¬ê¸ˆì•¡_B0": "BillingAmount_B0",
    "ì²­êµ¬ê¸ˆì•¡_R3M": "BillingAmount_R3M",
    "ì´ìš©ê¸ˆì•¡_ì‹ ìš©_B0M": "UsageAmount_Credit_B0M",
    "ì´ìš©ê¸ˆì•¡_ì˜¨ë¼ì¸_R3M": "UsageAmount_Online_R3M",
    "ì´ìš©ê¸ˆì•¡_ì˜¤í”„ë¼ì¸_R3M": "UsageAmount_Offline_R3M",
    "ì´ìš©ê¸ˆì•¡_ì˜¨ë¼ì¸_B0M": "UsageAmount_Online_B0M",
    "ì´ìš©ê¸ˆì•¡_ì˜¤í”„ë¼ì¸_B0M": "UsageAmount_Offline_B0M",
    "ì´ìš©ê¸ˆì•¡_í˜ì´_ì˜¨ë¼ì¸_B0M": "UsageAmount_PayOnline_B0M",
    "ì´ìš©ê¸ˆì•¡_í˜ì´_ì˜¤í”„ë¼ì¸_B0M": "UsageAmount_PayOffline_B0M",
    "ì´ìš©ê¸ˆì•¡_í˜ì´_ì˜¨ë¼ì¸_R3M": "UsageAmount_PayOnline_R3M",
    "ì´ìš©ê¸ˆì•¡_í˜ì´_ì˜¤í”„ë¼ì¸_R3M": "UsageAmount_PayOffline_R3M",
    "ì´ìš©ê¸ˆì•¡ëŒ€": "UsageAmountCategory",
    "ì„œìš¸": "Seoul",
    "ë¶€ì‚°": "Busan",
    "ëŒ€êµ¬": "Daegu",
    "ì¸ì²œ": "Incheon",
    "ê´‘ì£¼": "Gwangju",
    "ëŒ€ì „": "Daejeon",
    "ìš¸ì‚°": "Ulsan",
    "ì„¸ì¢…": "Sejong",
    "ê²½ê¸°": "Gyeonggi",
    "ê°•ì›": "Gangwon",
    "ì¶©ë¶": "Chungbuk",
    "ì¶©ë‚¨": "Chungnam",
    "ì „ë¶": "Jeonbuk",
    "ì „ë‚¨": "Jeonnam",
    "ê²½ë¶": "Gyeongbuk",
    "ê²½ë‚¨": "Gyeongnam",
    "ì œì£¼": "Jeju",
    "ì—†ìŒ": "None"
}

# ì ‘ë‘ì–´ ë³€í™˜ ë§µí•‘
def translate_prefix(prefix):
    prefix_mapping = {
        "ê±°ì£¼ì‹œë„ëª…": "ResidenceCity",
        "ì§ì¥ì‹œë„ëª…": "WorkCity"
    }
    return prefix_mapping.get(prefix, prefix)

# ë³€ìˆ˜ëª… ë³€í™˜ (ì ‘ë‘ì–´ ì˜ì–´ ë²ˆì—­ í¬í•¨)
def rename_columns(column_name):
    parts = column_name.split('_', 1)  # ì ‘ë‘ì–´ì™€ ë‚˜ë¨¸ì§€ ë¶„ë¦¬
    if len(parts) == 2:
        prefix, base_name = parts
        translated_prefix = translate_prefix(prefix)  # ì ‘ë‘ì–´ ë³€í™˜
        if base_name in column_mapping:
            return f"{translated_prefix}_{column_mapping[base_name]}"
        else:
            return f"{translated_prefix}_{base_name}"
    elif column_name in column_mapping:
        return column_mapping[column_name]
    return column_name

# ëª¨ë“  ì—´ ì´ë¦„ ë³€í™˜
data.columns = [rename_columns(col) for col in data.columns]

# ê²°ê³¼ ì €ì¥
data.to_csv(output_file, index=False)
print(f"ë³€ìˆ˜ëª…ì„ ì˜ì–´ë¡œ ë³€í™˜í•œ íŒŒì¼ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤: {output_file}")